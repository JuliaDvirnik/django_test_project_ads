{% extends "base.html" %}

{% block title %}–û–±—ä—è–≤–ª–µ–Ω–∏—è{% endblock %}

{% block content %}
  <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>

  {% if user.is_authenticated %}
    <p><a href="{% url 'create_ad' %}">‚ûï –ü–æ–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</a></p>
    <p><a href="{% url 'create_exchange' %}">üîÅ –û–±–º–µ–Ω—è—Ç—å</a></p>  
    <p><a href="{% url 'logout' %}">üîì –í—ã–π—Ç–∏</a></p>
  {% else %}
    <p><a href="{% url 'login' %}">üîê –í–æ–π—Ç–∏</a> –∏–ª–∏ <a href="{% url 'register' %}">üìù –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
  {% endif %}

  <hr>

  <form method="get">
    <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
      <input type="text" name="q" placeholder="–ü–æ–∏—Å–∫..." value="{{ query }}">
      <select name="category">
        <option value="">–õ—é–±–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è</option>
        {% for val, label in category_choices %}
          <option value="{{ val }}" {% if category == val %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>
      <select name="condition">
        <option value="">–õ—é–±–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</option>
        {% for val, label in condition_choices %}
          <option value="{{ val }}" {% if condition == val %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>
      <button type="submit">üîç –ù–∞–π—Ç–∏</button>
    </div>
  </form>

  <hr>

  {% if page_obj.object_list %}
    <ul>
      {% for ad in page_obj %}
        <li style="margin-bottom: 1em;">
          <a href="{% url 'ad_detail' ad.pk %}"><strong>{{ ad.title }}</strong></a><br>
          <small>{{ ad.get_condition_display }} | {{ ad.get_category_display }} | {{ ad.created_at|date:"d.m.Y H:i" }}</small>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>–û–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>
  {% endif %}

  <div>
    <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ page_obj.paginator.num_pages }}</span>
    <div>
      {% if page_obj.has_previous %}
        <a href="?{% if query %}q={{ query }}&{% endif %}{% if category %}category={{ category }}&{% endif %}{% if condition %}condition={{ condition }}&{% endif %}page={{ page_obj.previous_page_number }}">‚Üê –ù–∞–∑–∞–¥</a>
      {% endif %}

      {% if page_obj.has_next %}
        <a href="?{% if query %}q={{ query }}&{% endif %}{% if category %}category={{ category }}&{% endif %}{% if condition %}condition={{ condition }}&{% endif %}page={{ page_obj.next_page_number }}">–í–ø–µ—Ä—ë–¥ ‚Üí</a>
      {% endif %}
    </div>
  </div>
{% endblock %}